outputs:
  default:
    defaultId: logs
    type: default
  splunk:
    systemFields:
      - cribl_pipe
    port: 9997
    nestedFields: none
    throttleRatePerSec: "0"
    tls:
      disabled: true
    connectionTimeout: 10000
    writeTimeout: 60000
    enableMultiMetrics: false
    enableACK: true
    onBackpressure: block
    type: splunk
    host: splunk
    notifications:
      - disabled: false
        targets:
          - sns-email
        conf:
          name: splunk:splunk
          timeWindow: 60s
        condition: unhealthy-dest
        group: dc1-logs
        id: Splunk-unhealthy
    authType: manual
  statsd:
    systemFields:
      - cribl_pipe
    rules:
      - filter: index==="cribl-metrics"
        output: splunk-metrics
        final: false
      - filter: "false"
        output: localhost
        final: false
      - final: true
        filter: index==="cribl-metrics-multi"
        output: splunk-multimetrics
    type: router
    onBackpressure: block
  splunk-metrics:
    systemFields:
      - cribl_pipe
    port: 9998
    nestedFields: none
    throttleRatePerSec: "0"
    tls:
      disabled: true
    connectionTimeout: 10000
    writeTimeout: 60000
    enableMultiMetrics: false
    enableACK: true
    pipeline: metrics_to_logs
    onBackpressure: block
    type: splunk
    host: splunk
    authType: manual
  s3:
    type: s3
    awsAuthenticationMethod: manual
    bucket: archival
    destPath: ""
    stagePath: /tmp/cribl
    awsApiKey: ACCESSKEY
    awsSecretKey: "#42:jTL9JdVDlvuub+ct/bajgx77gWG4xCjP8E3K7VNohfY="
    region: us-east-1
    endpoint: http://minio:9000
    signatureVersion: v4
    partitionExpr: "`${__inputId.replace(/:/g, '_')}/${C.Time.strftime(_time ? _time :
      Date.now(), '%Y-%m-%d_%H')}/${host}/${sourcetype}`"
    format: json
    baseFileName: CriblOut
    compress: gzip
    maxFileSizeMB: 32
    maxFileOpenTimeSec: 60
    maxFileIdleTimeSec: 30
    maxOpenFiles: 100
    onBackpressure: block
  splunk-pan:
    systemFields:
      - cribl_pipe
    port: 9997
    nestedFields: none
    throttleRatePerSec: "0"
    tls:
      disabled: true
    connectionTimeout: 10000
    writeTimeout: 60000
    enableMultiMetrics: false
    enableACK: true
    onBackpressure: block
    type: splunk
    host: splunk
    authType: manual
  s3-pan:
    type: s3
    awsAuthenticationMethod: manual
    bucket: archival
    destPath: ""
    stagePath: /tmp/cribl
    awsApiKey: ACCESSKEY
    awsSecretKey: "#42:dTnK0xM1o/nY65IbwYQ1cM/gn/1dxunHAJpqgDDMd00="
    region: us-east-1
    endpoint: http://minio:9000
    signatureVersion: v4
    partitionExpr: "`${C.Time.strftime(_time ? _time : Date.now(),
      '%Y/%m/%d/%H')}/${sourcetype}/${src_zone}/${src_ip}/${dest_zone}/${dest_i\
      p}`"
    format: json
    baseFileName: CriblOut
    compress: gzip
    maxFileSizeMB: 32
    maxFileOpenTimeSec: 60
    maxFileIdleTimeSec: 30
    maxOpenFiles: 100
    onBackpressure: block
  pan-firewall-external:
    rules:
      - final: false
        filter: src_zone=='untrusted' || dest_zone=='untrusted'
        output: splunk-pan
      - final: true
        filter: "true"
        output: s3-pan
    type: router
  splunk-multimetrics:
    systemFields:
      - cribl_pipe
    port: 9998
    nestedFields: none
    throttleRatePerSec: "0"
    tls:
      disabled: true
    connectionTimeout: 10000
    writeTimeout: 60000
    enableMultiMetrics: true
    enableACK: true
    onBackpressure: block
    pipeline: metrics_to_logs
    type: splunk
    host: splunk
    authType: manual
  logs:
    systemFields:
      - cribl_pipe
    streamtags: []
    rules:
      - final: false
        filter: "true"
        output: splunk
    type: router
